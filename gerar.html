<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Gerar Certificado</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
</head>

<body class="container mt-5">

<h3>Gerar Certificado</h3>

<input id="nome" class="form-control mb-2" placeholder="Nome do aluno">
<input id="curso" class="form-control mb-2" placeholder="Curso">
<input id="horas" class="form-control mb-2" placeholder="Horas">
<input id="data" class="form-control mb-2" type="date">

<button class="btn btn-primary" onclick="gerar()">Gerar</button>

<hr>

<div id="qrcode"></div>

<script>

const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbxvfYp8lAAdF1bERhUjNP2DBkhscAhOOEgI5pFd36Jw6qzXG0v6NLSUxdXAWKZIZzjP/exec";

function gerar(){

  const id = "CERT-" + Date.now();

  const dados = {
    id: id,
    nome: document.getElementById("nome").value,
    curso: document.getElementById("curso").value,
    horas: document.getElementById("horas").value,
    data: document.getElementById("data").value
  };

  // envia para planilha
  fetch(URL_SCRIPT,{
    method:"POST",
    body: JSON.stringify(dados)
  });

  // cria QR Code
  document.getElementById("qrcode").innerHTML = "";

  new QRCode(document.getElementById("qrcode"), {
    text: "validar.html?id=" + id,
    width: 120,
    height: 120
  });
}

</script>

</body>
</html>
